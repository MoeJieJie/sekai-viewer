(this["webpackJsonpsekai-viewer"]=this["webpackJsonpsekai-viewer"]||[]).push([[18],{6037:function(e,a,t){"use strict";var n=t(1),r=t(2),l=t(0),c=(t(4),t(3)),i=t(5),o=l.forwardRef((function(e,a){var t=e.classes,i=e.className,o=e.component,s=void 0===o?"div":o,u=Object(r.a)(e,["classes","className","component"]);return l.createElement(s,Object(n.a)({className:Object(c.a)(t.root,i),ref:a},u))}));a.a=Object(i.a)({root:{padding:16,"&:last-child":{paddingBottom:24}}},{name:"MuiCardContent"})(o)},6176:function(e,a,t){"use strict";t.r(a);var n=t(12),r=t(172),l=t(40),c=t(5995),i=t(87),o=t(6183),s=t(6172),u=t(5991),d=t(5994),m=t(6037),g=t(5959),p=t(6048),f=t(6009),h=t(71),b=t(90),v=t(6177),y=t(6178),E=t(0),w=t.n(E),k=t(13),x=t(6038),j=t.n(x),O=t(36),_=t(6040),N=t(6041),I=t.n(N),C=t(5990),M=t(41),R={1:{bg:"bg_gacha1",feature:"img_gacha1_1"},2:{bg:"bg_gacha_rare3_ticket_2020"},3:{bg:"bg_gacha_virtualsinger_2020"}},W=Object(r.a)((function(e){return{media:{paddingTop:"56.25%",cursor:"pointer"},card:{margin:e.spacing(.5)},tabpanel:{padding:e.spacing("1%",0,0,0)},subheader:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","max-width":"260px"},gachaBtn:{margin:e.spacing(0,1)}}}));function D(e){var a=[];return R[e.id]?(R[e.id].bg&&a.push({src:"".concat("https://sekai-res.dnaroma.eu","/file/sekai-assets/gacha/").concat(e.assetbundleName,"/screen_rip/texture/").concat(R[e.id].bg,".webp"),alt:"background",downloadUrl:"".concat("https://sekai-res.dnaroma.eu","/file/sekai-assets/gacha/").concat(e.assetbundleName,"/screen_rip/texture/").concat(R[e.id].bg,".webp")}),R[e.id].feature&&a.push({src:"".concat("https://sekai-res.dnaroma.eu","/file/sekai-assets/gacha/").concat(e.assetbundleName,"/screen_rip/texture/").concat(R[e.id].feature,".webp"),alt:"feature",downloadUrl:"".concat("https://sekai-res.dnaroma.eu","/file/sekai-assets/gacha/").concat(e.assetbundleName,"/screen_rip/texture/").concat(R[e.id].feature,".webp")})):(a.push({src:"".concat("https://sekai-res.dnaroma.eu","/file/sekai-assets/gacha/").concat(e.assetbundleName,"/screen_rip/texture/bg_gacha").concat(e.id,".webp"),alt:"background",downloadUrl:"".concat("https://sekai-res.dnaroma.eu","/file/sekai-assets/gacha/").concat(e.assetbundleName,"/screen_rip/texture/bg_gacha").concat(e.id,".webp")}),a.push({src:"".concat("https://sekai-res.dnaroma.eu","/file/sekai-assets/gacha/").concat(e.assetbundleName,"/screen_rip/texture/img_gacha").concat(e.id,".webp"),alt:"feature",downloadUrl:"".concat("https://sekai-res.dnaroma.eu","/file/sekai-assets/gacha/").concat(e.assetbundleName,"/screen_rip/texture/img_gacha").concat(e.id,".webp")})),a}var B=function(e){var a=e.num;return w.a.createElement(E.Fragment,null,Array.from({length:a}).map((function(e,a){return w.a.createElement("img",{key:a,src:I.a,alt:"star",height:"24px"})})))};a.default=function(e){var a=e.contentTransMode,t=W(),r=Object(b.a)(),x=Object(k.g)().gachaId,N=Object(C.a)().t,I=Object(M.a)(),S=Object(E.useState)(),Y=Object(n.a)(S,2),A=Y[0],F=Y[1],G=Object(O.c)("gachas"),T=Object(n.a)(G,1)[0],U=Object(E.useState)(!1),L=Object(n.a)(U,2),z=L[0],J=L[1],P=Object(E.useState)("4"),V=Object(n.a)(P,2),X=V[0],q=V[1],H=Object(E.useState)(0),K=Object(n.a)(H,2),Q=K[0],Z=K[1],$=Object(E.useState)({total:0,rarity1:0,rarity2:0,rarity3:0,rarity4:0}),ee=Object(n.a)($,2),ae=ee[0],te=ee[1],ne=Object(E.useState)([]),re=Object(n.a)(ne,2),le=re[0],ce=re[1],ie=Object(O.e)(!1),oe=Object(n.a)(ie,3),se=oe[1],ue=oe[2],de=Object(O.c)("cards"),me=Object(n.a)(de,1)[0];function ge(e){for(var a=e,t=[null===A||void 0===A?void 0:A.rarity1Rate,(null===A||void 0===A?void 0:A.rarity1Rate)+(null===A||void 0===A?void 0:A.rarity2Rate),(null===A||void 0===A?void 0:A.rarity1Rate)+(null===A||void 0===A?void 0:A.rarity2Rate)+(null===A||void 0===A?void 0:A.rarity3Rate),(null===A||void 0===A?void 0:A.rarity1Rate)+(null===A||void 0===A?void 0:A.rarity2Rate)+(null===A||void 0===A?void 0:A.rarity3Rate)+(null===A||void 0===A?void 0:A.rarity4Rate)],n=[100-(null===A||void 0===A?void 0:A.rarity4Rate),100],r=[null===A||void 0===A?void 0:A.gachaDetails.filter((function(e){var a;return 1===(null===(a=me.find((function(a){return a.id===e.cardId})))||void 0===a?void 0:a.rarity)})),null===A||void 0===A?void 0:A.gachaDetails.filter((function(e){var a;return 2===(null===(a=me.find((function(a){return a.id===e.cardId})))||void 0===a?void 0:a.rarity)})),null===A||void 0===A?void 0:A.gachaDetails.filter((function(e){var a;return 3===(null===(a=me.find((function(a){return a.id===e.cardId})))||void 0===a?void 0:a.rarity)})),null===A||void 0===A?void 0:A.gachaDetails.filter((function(e){var a;return 4===(null===(a=me.find((function(a){return a.id===e.cardId})))||void 0===a?void 0:a.rarity)}))],l=[],c=0,i=0;i<a;i++)if(i%10!==9||9!==c){i%10===0&&(c=0);var o,s=99*Math.random()+1;if(s<=t[0])te((function(e){return Object.assign({},e,{total:e.total+1,rarity1:e.rarity1+1})})),l.push(r[0][Math.floor(Math.random()*(null===(o=r[0])||void 0===o?void 0:o.length))]),c++;else if(s<=t[1]){var u;te((function(e){return Object.assign({},e,{total:e.total+1,rarity2:e.rarity2+1})})),l.push(r[1][Math.floor(Math.random()*(null===(u=r[1])||void 0===u?void 0:u.length))]),c++}else if(s<=t[2]){var d;te((function(e){return Object.assign({},e,{total:e.total+1,rarity3:e.rarity3+1})})),l.push(r[2][Math.floor(Math.random()*(null===(d=r[2])||void 0===d?void 0:d.length))])}else if(s<=t[3]){var m;te((function(e){return Object.assign({},e,{total:e.total+1,rarity4:e.rarity4+1})})),l.push(r[3][Math.floor(Math.random()*(null===(m=r[3])||void 0===m?void 0:m.length))])}else console.log(s,t)}else{var g,p=99*Math.random()+1;if(p<n[0])te((function(e){return Object.assign({},e,{total:e.total+1,rarity3:e.rarity3+1})})),l.push(r[2][Math.floor(Math.random()*(null===(g=r[2])||void 0===g?void 0:g.length))]);else if(p<n[1]){var f;te((function(e){return Object.assign({},e,{total:e.total+1,rarity4:e.rarity4+1})})),l.push(r[3][Math.floor(Math.random()*(null===(f=r[3])||void 0===f?void 0:f.length))])}else console.log(p,n);c=0}ce(l.slice(-10))}Object(E.useEffect)((function(){ue(Boolean(T.length)),Boolean(T.length)&&F(T.find((function(e){return e.id===Number(x)})))}),[ue,x,T]),Object(E.useEffect)((function(){A&&(document.title="".concat("original"===a?A.name:"translated"===a?I.t("gacha_name:".concat(x)):A.name," | Gacha | Sekai Viewer"))}),[A,I,a,x]);return se&&A?w.a.createElement(E.Fragment,null,w.a.createElement(l.a,{variant:"h6",className:r.header},"original"===a?A.name:"translated"===a?I.t("gacha_name:".concat(x)):A.name),w.a.createElement(c.a,{className:r.content,maxWidth:"sm"},w.a.createElement(v.a,{value:X},w.a.createElement(i.a,null,w.a.createElement(o.a,{value:X,onChange:function(e,a){q(a)},variant:"scrollable",scrollButtons:"desktop"},w.a.createElement(s.a,{label:N("gacha:tab.title[0]"),value:"2"}),w.a.createElement(s.a,{label:N("gacha:tab.title[1]"),value:"3"}),w.a.createElement(s.a,{label:N("gacha:tab.title[2]"),value:"4"}),w.a.createElement(s.a,{label:N("gacha:tab.title[3]"),value:"0"}),R[A.id]?R[A.id].feature?w.a.createElement(s.a,{label:N("gacha:tab.title[4]"),value:"1"}):null:A.id>=4?w.a.createElement(s.a,{label:N("gacha:tab.title[4]"),value:"1"}):null),w.a.createElement(y.a,{value:"0",classes:{root:t.tabpanel}},w.a.createElement(u.a,{onClick:function(){Z(0),J(!0)}},w.a.createElement(d.a,{className:t.media,image:A?"".concat("https://sekai-res.dnaroma.eu","/file/sekai-assets/gacha/").concat(A.assetbundleName,"/screen_rip/texture/").concat(R[A.id]?R[A.id].bg:"bg_gacha".concat(x),".webp"):""}))),w.a.createElement(y.a,{value:"1",classes:{root:t.tabpanel}},w.a.createElement(u.a,{onClick:function(){Z(1),J(!0)}},w.a.createElement(d.a,{className:t.media,image:A?"".concat("https://sekai-res.dnaroma.eu","/file/sekai-assets/gacha/").concat(A.assetbundleName,"/screen_rip/texture/").concat(R[A.id]?R[A.id].feature:"img_gacha".concat(x),".webp"):""}))),w.a.createElement(y.a,{value:"2",classes:{root:t.tabpanel}},w.a.createElement(u.a,null,w.a.createElement(m.a,null,A.gachaInformation.description.split("\n").map((function(e,a){return w.a.createElement(l.a,{paragraph:!0,variant:"body2",key:"desc-".concat(a)},e)}))))),w.a.createElement(y.a,{value:"3",classes:{root:t.tabpanel}},w.a.createElement(u.a,null,w.a.createElement(m.a,null,A.gachaInformation.summary.split("\n").map((function(e,a){return w.a.createElement(l.a,{paragraph:!0,variant:"body2",key:"summary-".concat(a)},e)}))))),w.a.createElement(y.a,{value:"4",classes:{root:t.tabpanel}},w.a.createElement(u.a,null,w.a.createElement(m.a,null,w.a.createElement(l.a,{paragraph:!0},w.a.createElement(B,{num:2}),A.rarity2Rate," % ",w.a.createElement(B,{num:3}),A.rarity3Rate," % ",w.a.createElement(B,{num:4}),A.rarity4Rate," %"),w.a.createElement("div",null,w.a.createElement(g.a,{variant:"contained",className:t.gachaBtn,color:"secondary",onClick:function(){return ge(1)}},"Gacha!"),w.a.createElement(g.a,{variant:"contained",className:t.gachaBtn,color:"primary",onClick:function(){return ge(10)}},"Gacha * 10"),w.a.createElement(g.a,{variant:"contained",className:t.gachaBtn,color:"primary",onClick:function(){return ge(100)}},"Gacha * 100"),w.a.createElement(g.a,{variant:"contained",className:t.gachaBtn,color:"primary",onClick:function(){return ge(1e3)}},"Gacha * 1000"),w.a.createElement(g.a,{variant:"contained",className:t.gachaBtn,color:"primary",onClick:function(){return te({total:0,rarity1:0,rarity2:0,rarity3:0,rarity4:0}),void ce([])}},"Reset")),w.a.createElement(l.a,{paragraph:!0},w.a.createElement("span",{style:{marginRight:"1%"}},"Total: ",ae.total),w.a.createElement(B,{num:2}),ae.rarity2," ",ae.total?(ae.rarity2/ae.total*100).toFixed(2):0," ","%",w.a.createElement(B,{num:3}),ae.rarity3," ",ae.total?(ae.rarity3/ae.total*100).toFixed(2):0," ","%",w.a.createElement(B,{num:4}),ae.rarity4," ",ae.total?(ae.rarity4/ae.total*100).toFixed(2):0," ","%")),w.a.createElement(m.a,null,w.a.createElement(_.c,{cardIds:le.map((function(e){return e.cardId}))})))))),w.a.createElement(p.a,{paddingX:"2%",display:"flex",flexDirection:"column"},w.a.createElement(p.a,{display:"flex",flexDirection:"row",flexWrap:"no-wrap",justifyContent:"space-between",alignItems:"center",paddingY:"1%"},w.a.createElement(l.a,{variant:"subtitle1",style:{fontWeight:600}},N("common:id")),w.a.createElement(l.a,null,A.id)),w.a.createElement(f.a,null),w.a.createElement(p.a,{display:"flex",flexDirection:"row",flexWrap:"no-wrap",justifyContent:"space-between",alignItems:"center",paddingY:"1%"},w.a.createElement(l.a,{variant:"subtitle1",style:{fontWeight:600}},N("common:title")),w.a.createElement(l.a,null,"original"===a?A.name:"translated"===a?I.t("gacha_name:".concat(x)):A.name)),w.a.createElement(f.a,null),w.a.createElement(p.a,{display:"flex",flexDirection:"row",flexWrap:"no-wrap",justifyContent:"space-between",alignItems:"center",paddingY:"1%"},w.a.createElement(l.a,{variant:"subtitle1",style:{fontWeight:600}},N("common:icon")),w.a.createElement("img",{style:{maxWidth:"50%"},src:"".concat("https://sekai-res.dnaroma.eu","/file/sekai-assets/gacha/").concat(A.assetbundleName,"/logo_rip/logo.webp"),alt:"logo icon"})),w.a.createElement(f.a,null),w.a.createElement(p.a,{display:"flex",flexDirection:"row",flexWrap:"no-wrap",justifyContent:"space-between",alignItems:"center",paddingY:"1%"},w.a.createElement(l.a,{variant:"subtitle1",style:{fontWeight:600}},N("common:startAt")),w.a.createElement(l.a,null,new Date(A.startAt).toLocaleString())),w.a.createElement(f.a,null),w.a.createElement(p.a,{display:"flex",flexDirection:"row",flexWrap:"no-wrap",justifyContent:"space-between",alignItems:"center",paddingY:"1%"},w.a.createElement(l.a,{variant:"subtitle1",style:{fontWeight:600}},N("common:endAt")),w.a.createElement(l.a,null,new Date(A.endAt).toLocaleString())),w.a.createElement(f.a,null),w.a.createElement(p.a,{display:"flex",flexDirection:"row",flexWrap:"no-wrap",justifyContent:"space-between",alignItems:"center",paddingY:"1%"},w.a.createElement(l.a,{variant:"subtitle1",style:{fontWeight:600}},N("common:type")),w.a.createElement(l.a,null,N("gacha:gachaType.".concat(A.gachaType)))),w.a.createElement(f.a,null),w.a.createElement(h.a,{container:!0,wrap:"nowrap",justify:"space-between",alignItems:"center",style:{padding:"1% 0"}},w.a.createElement(l.a,{variant:"subtitle1",style:{fontWeight:600}},N("gacha:pickupMember",{count:A.gachaPickups.length})),w.a.createElement(h.a,{item:!0,container:!0,direction:"row",xs:6,spacing:1,justify:"flex-end"},A.gachaPickups.map((function(e){return w.a.createElement(h.a,{key:"pickup-".concat(e.id),item:!0,xs:8,md:4},w.a.createElement(_.a,{id:e.cardId}))})))),w.a.createElement(f.a,null))),w.a.createElement(j.a,{visible:z,onClose:function(){return J(!1)},images:D(A),zIndex:2e3,activeIndex:Q,downloadable:!0,downloadInNewWindow:!0,onMaskClick:function(){return J(!1)},zoomSpeed:.25,onChange:function(e,a){return Z(a)}})):w.a.createElement("div",null,"Loading... If you saw this for a while, gacha ",x," does not exist.")}}}]);
//# sourceMappingURL=18.c86ed0e7.chunk.js.map